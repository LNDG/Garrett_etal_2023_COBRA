%E_0_create_SDnback_PCAdim_PLSanalysis_MAT

BASEPATH='BASE';

PLSPATH=([BASEPATH, '/PLS_nback/']);
%N181
%ID_N181={'001', '002', '003', '006', '007', '008', '009', '010', '011', '013', '014', '015', '016', '017', '018', '019', '021', '022', '023', '024', '025', '026', '027', '028', '029', '030', '031', '032', '033', '034', '035', '036', '037', '038', '039', '040', '041', '043', '045', '046', '047', '049', '050', '051', '052', '053', '054', '056', '057', '058', '059', '060', '061', '063', '064', '065', '066', '067', '068', '069', '071', '072', '073', '074', '075', '076', '079', '080', '081', '082', '083', '084', '085', '087', '090', '091', '092', '093', '094', '095', '096', '097', '098', '099', '104', '105', '106', '107', '108', '109', '110', '112', '113', '114', '116', '117', '118', '119', '120', '121', '122', '123', '126', '127', '130', '131', '132', '133', '134', '135', '136', '137', '138', '139', '140', '141', '142', '143', '144', '146', '148', '149', '150', '152', '153', '154', '155', '156', '158', '159', '160', '161', '162', '163', '164', '165', '168', '169', '170', '172', '173', '174', '176', '177', '178', '179', '180', '181', '183', '184', '185', '186', '187', '188', '190', '191', '192', '193', '194', '195', '196', '197', '198', '199', '200', '201', '202', '203', '204', '205', '206', '208', '210', '211', '212', '213', '214', '216', '217', '219', '220'};
%N163
ID={'001', '003', '006', '007', '008', '009', '010', '013', '014', '015', '016', '017', '018', '019', '021', '022', '024', '025', '027', '028', '029', '030', '032', '033', '034', '035', '036', '038', '040', '041', '043', '045', '046', '049', '050', '051', '052', '053', '056', '057', '058', '059', '060', '061', '063', '064', '065', '066', '067', '068', '069', '071', '072', '073', '074', '075', '076', '079', '080', '081', '082', '084', '085', '087', '090', '091', '092', '093', '094', '095', '097', '099', '104', '105', '106', '107', '108', '109', '110', '112', '113', '114', '116', '117', '118', '119', '120', '121', '122', '123', '126', '127', '130', '131', '133', '134', '135', '136', '137', '138', '139', '140', '143', '144', '146', '148', '149', '150', '152', '153', '154', '155', '156', '158', '159', '160', '161', '162', '163', '164', '165', '168', '169', '170', '172', '173', '174', '176', '177', '178', '180', '181', '183', '184', '185', '186', '187', '188', '190', '191', '192', '193', '194', '195', '196', '197', '198', '199', '200', '201', '203', '204', '206', '208', '210', '211', '212', '213', '214', '216', '217', '219', '220'};
ID181={'001', '002', '003', '006', '007', '008', '009', '010', '011', '013', '014', '015', '016', '017', '018', '019', '021', '022', '023', '024', '025', '026', '027', '028', '029', '030', '031', '032', '033', '034', '035', '036', '037', '038', '039', '040', '041', '043', '045', '046', '047', '049', '050', '051', '052', '053', '054', '056', '057', '058', '059', '060', '061', '063', '064', '065', '066', '067', '068', '069', '071', '072', '073', '074', '075', '076', '079', '080', '081', '082', '083', '084', '085', '087', '090', '091', '092', '093', '094', '095', '096', '097', '098', '099', '104', '105', '106', '107', '108', '109', '110', '112', '113', '114', '116', '117', '118', '119', '120', '121', '122', '123', '126', '127', '130', '131', '132', '133', '134', '135', '136', '137', '138', '139', '140', '141', '142', '143', '144', '146', '148', '149', '150', '152', '153', '154', '155', '156', '158', '159', '160', '161', '162', '163', '164', '165', '168', '169', '170', '172', '173', '174', '176', '177', '178', '179', '180', '181', '183', '184', '185', '186', '187', '188', '190', '191', '192', '193', '194', '195', '196', '197', '198', '199', '200', '201', '202', '203', '204', '205', '206', '208', '210', '211', '212', '213', '214', '216', '217', '219', '220'};

%for masking the  dimensionality values
mask_181=ismember(ID181, ID);

load([PLSPATH, '/scripts/toolboxes/PLS_batch_matrix_input_savev7.3/templates/behav_BfMRIanalysis.mat']); %load MAT template 

%load PCAdim
%temporal
load([PLSPATH, '/Dimensionality_nback/temporal_PCA/N181_PCAcorr_dimensionality_temporal.mat']);

%spatial
%load([BASEPATH, '/Dimensionality_nback/spatial_PCA/N181_PCAcorr_dimensionality_spatial.mat']);


%oldID = erase(subjID,'C'); %replace Cs by space
permutations=1000; 
bootstrap=1000; 

%temporal
batch_file.result_file=['behavPLS_COBRA_N163_SDBOLDnback_temporalPCAdim_', num2str(permutations), 'P', num2str(bootstrap), 'B_BfMRIresult.mat']; %name result file 
%spatial
%batch_file.result_file=['behavPLS_COBRA_N163_SDBOLDnback_spatialPCAdim_', num2str(permutations), 'P', num2str(bootstrap), 'B_BfMRIresult.mat']; %name result file 

batch_file.smallResult=0; % produce small result file
batch_file.num_split=0; % no split-halfs
batch_file.selected_cond=[1, 1, 1, 0]; % all three conditions
batch_file.num_boot=bootstrap; 
batch_file.num_perm=permutations; 
num_cond=length(find(batch_file.selected_cond)); 
num_subj=length(ID);


for i=1:num_subj
    batch_file.group_files{1, 1}{i, 1} = (['SD_C', ID{i}, '_2mm_BfMRIsessiondata.mat']);
end

for k=1:num_cond
    behav_values((num_subj*(k-1)+1):(k*num_subj), 1)=dimensionality(mask_181, k); %stack all 3 condition PCAdim values 
end

batch_file.behavdata=behav_values; %PCAdim
% %temporal
 batch_file.behavname={'temporalPCAdim'};
 save([PLSPATH, 'SD_2mm/behavPLS_COBRA_N163_SDBOLDnback_temporalPCAdim_', num2str(permutations), 'P', num2str(bootstrap), 'B_BfMRIanalysis.mat'], 'batch_file');

%spatial
% batch_file.behavname={'spatialPCAdim'};
% save([PLSPATH, 'SD_2mm/behavPLS_COBRA_N163_SDBOLDnback_spatialPCAdim_', num2str(permutations), 'P', num2str(bootstrap), 'B_BfMRIanalysis.mat'], 'batch_file');


